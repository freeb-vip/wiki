import os
import zipfile

# -----------------------------
# æ–‡ä»¶å¤¹æ ¹ç›®å½•
# -----------------------------
ROOT_DIR = "wiki_export"

# -----------------------------
# å®šä¹‰ç›®å½•ç»“æ„å’Œé¡µé¢
# -----------------------------
wiki_structure = {
    "00_é¦–é¡µ": {
        "é¦–é¡µå¯¼èˆª.md": "# ğŸ¢ æ¬¢è¿æ¥åˆ°å…¬å¸ Wiki\n\n<!-- é¦–é¡µå¡ç‰‡å¼å¯¼èˆª HTML æ”¾è¿™é‡Œ -->"
    },
    "01_å…¬å¸æ¦‚å†µ": {
        "å…¬å¸ç®€ä»‹": {
            "ä¼ä¸šæ–‡åŒ–_æ„¿æ™¯_ä½¿å‘½.md": "# ä¼ä¸šæ–‡åŒ–_æ„¿æ™¯_ä½¿å‘½\n\n## é¡µé¢è¯´æ˜\n## å†…å®¹\n## æ›´æ–°è®°å½•",
            "ç»„ç»‡æ¶æ„å›¾.md": "# ç»„ç»‡æ¶æ„å›¾\n\n## é¡µé¢è¯´æ˜\n## å†…å®¹\n## æ›´æ–°è®°å½•"
        },
        "è”ç³»æ–¹å¼ä¸æ²Ÿé€šæ–¹å¼": {
            "éƒ¨é—¨è´Ÿè´£äººè”ç³»æ–¹å¼.md": "# éƒ¨é—¨è´Ÿè´£äººè”ç³»æ–¹å¼",
            "å¸¸ç”¨è½¯ä»¶è´¦å·åˆ—è¡¨.md": "# å¸¸ç”¨è½¯ä»¶è´¦å·åˆ—è¡¨"
        },
        "å…¬å¸å…¬å‘Š.md": "# å…¬å¸å…¬å‘Š"
    },
    "02_è¿è¥éƒ¨": {
        "åº—é“ºç®¡ç†": {
            "å„å¹³å°åº—é“ºä¿¡æ¯.md": "# å„å¹³å°åº—é“ºä¿¡æ¯",
            "åº—é“º_KPI_æŒ‡æ ‡ä½“ç³».md": "# åº—é“º_KPI_æŒ‡æ ‡ä½“ç³»"
        },
        "äº§å“ä¸å†…å®¹": {
            "å•†å“ä¸Šæ¶è§„èŒƒ.md": "# å•†å“ä¸Šæ¶è§„èŒƒ",
            "ä¿ƒé”€æ´»åŠ¨æ–‡æ¡£.md": "# ä¿ƒé”€æ´»åŠ¨æ–‡æ¡£",
            "æ–‡æ¡ˆæ¨¡æ¿.md": "# æ–‡æ¡ˆæ¨¡æ¿"
        },
        "å®¢æœä¸å”®å": {
            "å®¢æœ_SOP.md": "# å®¢æœ_SOP",
            "å”®åå¤„ç†æµç¨‹.md": "# å”®åå¤„ç†æµç¨‹",
            "å®¢æˆ·æŠ•è¯‰å¤„ç†æŒ‡å—.md": "# å®¢æˆ·æŠ•è¯‰å¤„ç†æŒ‡å—"
        }
    },
    "03_æŠ€æœ¯éƒ¨": {
        "ç³»ç»Ÿè¿ç»´": {
            "æœåŠ¡å™¨_é›†ç¾¤ç®¡ç†.md": "# æœåŠ¡å™¨_é›†ç¾¤ç®¡ç†",
            "æ•°æ®åº“éƒ¨ç½²å’Œå¤‡ä»½.md": "# æ•°æ®åº“éƒ¨ç½²å’Œå¤‡ä»½",
            "ç½‘ç»œä¸å®‰å…¨ç­–ç•¥.md": "# ç½‘ç»œä¸å®‰å…¨ç­–ç•¥"
        },
        "å¼€å‘æ–‡æ¡£": {
            "å†…éƒ¨å·¥å…·ä½¿ç”¨æ‰‹å†Œ.md": "# å†…éƒ¨å·¥å…·ä½¿ç”¨æ‰‹å†Œ",
            "API_æ•°æ®æ¥å£è§„èŒƒ.md": "# API_æ•°æ®æ¥å£è§„èŒƒ",
            "è‡ªåŠ¨åŒ–è„šæœ¬ç®¡ç†.md": "# è‡ªåŠ¨åŒ–è„šæœ¬ç®¡ç†"
        },
        "æŠ€æœ¯çŸ¥è¯†åº“": {
            "å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ.md": "# å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ",
            "æŠ€æœ¯æ–¹æ¡ˆè®¨è®ºè®°å½•.md": "# æŠ€æœ¯æ–¹æ¡ˆè®¨è®ºè®°å½•",
            "DevOpså·¥å…·é“¾è¯´æ˜.md": "# DevOpså·¥å…·é“¾è¯´æ˜"
        }
    },
    "04_é‡‡è´­éƒ¨": {
        "ä¾›åº”å•†ä¿¡æ¯åº“.md": "# ä¾›åº”å•†ä¿¡æ¯åº“",
        "é‡‡è´­æµç¨‹.md": "# é‡‡è´­æµç¨‹",
        "ä»·æ ¼ä¸æˆæœ¬åˆ†æ.md": "# ä»·æ ¼ä¸æˆæœ¬åˆ†æ",
        "é‡‡è´­_KPI.md": "# é‡‡è´­_KPI"
    },
    "05_ä¾›åº”é“¾": {
        "ä»“å‚¨ä¸ç‰©æµ.md": "# ä»“å‚¨ä¸ç‰©æµ",
        "è¿è¾“æ–‡æ¡£ä¸æŠ¥è¡¨.md": "# è¿è¾“æ–‡æ¡£ä¸æŠ¥è¡¨",
        "åº“å­˜ç®¡ç†.md": "# åº“å­˜ç®¡ç†",
        "å¼‚å¸¸å¤„ç†æµç¨‹.md": "# å¼‚å¸¸å¤„ç†æµç¨‹"
    },
    "06_SOP": {
        "è¿è¥_SOP.md": "# è¿è¥_SOP",
        "æŠ€æœ¯_SOP.md": "# æŠ€æœ¯_SOP",
        "é‡‡è´­_SOP.md": "# é‡‡è´­_SOP",
        "ä¾›åº”é“¾_SOP.md": "# ä¾›åº”é“¾_SOP"
    },
    "07_é™„ä»¶ä¸æ¨¡æ¿": {
        "Excel_CSV_æ–‡æ¡£æ¨¡æ¿.md": "# Excel/CSV/æ–‡æ¡£æ¨¡æ¿",
        "æµç¨‹å›¾_ç¤ºæ„å›¾.md": "# æµç¨‹å›¾/ç¤ºæ„å›¾",
        "åŸ¹è®­ææ–™.md": "# åŸ¹è®­ææ–™"
    }
}

# -----------------------------
# åˆ›å»ºæ–‡ä»¶å¤¹å’Œ Markdown æ–‡ä»¶
# -----------------------------
def create_structure(base_path, structure):
    for name, content in structure.items():
        path = os.path.join(base_path, name)
        if isinstance(content, dict):
            os.makedirs(path, exist_ok=True)
            create_structure(path, content)
        else:
            os.makedirs(base_path, exist_ok=True)
            with open(path, "w", encoding="utf-8") as f:
                f.write(content)

# -----------------------------
# åˆ›å»ºå‹ç¼©åŒ…
# -----------------------------
def zip_folder(folder_path, zip_name):
    with zipfile.ZipFile(zip_name, "w", zipfile.ZIP_DEFLATED) as zipf:
        for root, dirs, files in os.walk(folder_path):
            for file in files:
                file_path = os.path.join(root, file)
                zipf.write(file_path, os.path.relpath(file_path, folder_path))

# -----------------------------
# æ‰§è¡Œ
# -----------------------------
create_structure(ROOT_DIR, wiki_structure)
zip_folder(ROOT_DIR, "wiki.zip")
print("âœ… wiki.zip å·²ç”Ÿæˆï¼ŒåŒ…å«é¦–é¡µå¯¼èˆªå’Œæ‰€æœ‰ Markdown é¡µé¢ï¼")
